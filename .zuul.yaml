- job:
    name: brick-cinderclient-dsvm-functional
    parent: devstack-tox-functional
    description: |
      devstack-based functional tests for python-brick-cinderclient-ext
    required-projects:
      - openstack/python-cinderclient
    timeout: 4200
    vars:
      devstack_localrc:
        LIBS_FROM_GIT: python-cinderclient
      devstack_services:
        # turn off ceilometer
        ceilometer-acentral: false
        ceilometer-acompute: false
        ceilometer-alarm-evaluator: false
        ceilometer-alarm-notifier: false
        ceilometer-anotification: false
        ceilometer-api: false
        ceilometer-collector: false
      # Hardcode brick-cinderclient path so the job can be run on other repo patches
      zuul_work_dir: src/opendev.org/openstack/python-brick-cinderclient-ext

- project:
    templates:
      - openstack-python-jobs
      - openstack-python35-jobs
      - publish-openstack-sphinx-docs
      - check-requirements
      - release-notes-jobs
    check:
      jobs:
        - brick-cinderclient-dsvm-functional
    gate:
      jobs:
        - brick-cinderclient-dsvm-functional
